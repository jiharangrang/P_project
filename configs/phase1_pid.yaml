hardware:
  use_led: true
  use_beep: true
  led_on_start: true
  beep_on_start: true
  led_mode: 2
  servo_defaults: [87, 29]
  servo_neutral: [90, 25]
  camera:
    index: 0
    resolution: [320, 240]
    brightness: 0
    contrast: 0
    saturation: 50
    exposure: 100
    gain: 0

perception:
  mode: lab             # lab | hsv
  roi_top: 756          # 0~1000 스케일
  roi_bottom: 946       # 0~1000 스케일
  ipm_resolution: [320, 240]
  hsv:
    detect_value: 170   # 밝은 회색 임계 (HSV/그레이)
  lab:
    detect_value: 170   # L 밝기 임계
    red_l_min: 30
    red_a_min: 150
    red_b_min: 140
    gray_a_dev: 15
    gray_b_dev: 15

  # YOLO 인식(이벤트 공급자)
  yolo:
    enabled: true
    model: models/yolo/best.pt
    imgsz: 320
    conf: 0.5
    infer_interval_s: 0.1   # YOLO 추론 최소 간격(0이면 매 프레임 시도)
    confirm_frames: 3
    car_cooldown_s: 2.0
    min_area_ratio:
      red: 0.01
      green: 0.01
      oo: 0.08
      xx: 0.08
      car: 0.01

control:
  base_speed: 40        # 직진 기본 속도
  speed_limit: 120      # 모터 포화 한계
  steer_limit: 80       # PID 출력 한계 (좌/우)
  steer_scale: 1.0
  steer_deadband: 0.0
  kp: 45.0
  ki: 0.0
  kd: 8.0

  # 좌/우 턴 감지 및 제어 스케일
  turn:
    slope_thresh: 0.01     # heading 기울기 임계
    offset_thresh: 0.10    # 중심 오차 임계
    speed_scale: 0.50      # 턴 시 감속 계수
    steer_scale: 2.50      # 턴 시 조향 스케일 배율

  # heading(주황선) 기반 조향 가중치
  heading:
    smooth_alpha: 0.20     # EMA로 부드럽게
    connect_close_px: 1    # heading 중심 계산 시 도로 마스크 연결 범위
    merge_gap_px: 1        # p2/p3 병합 시 허용 간격
    p1_margin_px: 1        # p1 포함 여유 확장 픽셀

runtime:
  show_windows: true
  print_debug: true
  fail_safe_beep: true
  fps_window: 15
  headless_delay: 0.003

# Layer B 미션 파라미터
mission:
  hazard:
    beep_delay: 0.5
  parking:
    approach_speed: 20
    missing_frames: 3
    steer_kp: 0.8
